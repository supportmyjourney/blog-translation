!function(){const sheetId="1AbzUCm0kw5YIVlWHkM1--G2s1hyPNFJr-p76zcQev60",keyword=window.donationKeyword||"",lang=(localStorage.getItem("selectedLang")||navigator.language||"en-us").toLowerCase(),supported=["en-us","en-uk","fr","de","es","pt","jp","kr"],activeLang=supported.includes(lang)?lang:"en-us";if(!keyword)return console.error("Missing donationKeyword");const url=(s)=>`https://opensheet.elk.sh/${sheetId}/${s}`;Promise.all([fetch(url("Targets")).then(r=>r.json()),fetch(url("Donations")).then(r=>r.json())]).then(([tRes,dRes])=>{const t=tRes.find(r=>r.Keyword===keyword);let content={title:"Donation Campaign",goalTitle:"Goal",raisedTitle:"Raised",historyTitle:"Recent Donations"};if(t&&t[activeLang])try{content=JSON.parse(t[activeLang])}catch{};const goal=parseFloat(t?.Goal||0),all=dRes.filter(d=>d.Keyword===keyword&&d.Amount&&d.Currency==="USD");let total=0,history=all.map(d=>{const a=parseFloat(d.Amount);return total+=a,{name:d.Name||"Anonymous",date:d.Date||"",message:d.Message||"",amount:a.toFixed(2)}}),percent=Math.min(100,Math.round(total/goal*100)),color=`rgb(${Math.round(76*percent/100)},${Math.round(112+(175-112)*percent/100)},${Math.round(186+(80-186)*percent/100)})`;document.getElementById("donation-display").innerHTML=`
    <h2>${content.title}</h2>
    <p><strong>${content.goalTitle}:</strong> $${goal}</p>
    <p><strong>${content.raisedTitle}:</strong> $${total.toFixed(2)} (${percent}%)</p>
    <div class="progress-bar-wrapper"><div class="progress-bar-fill" style="width:${percent}%;background:${color};">${percent}%</div></div>
    <h3>${content.historyTitle}</h3>
    <div id="donation-list" class="donation-list"></div>
    <div style="text-align:center;"><button id="show-more-btn" class="show-more-btn">Show more</button></div>`;let shown=0,maxDefault=5;const renderMore=()=>{const c=document.getElementById("donation-list"),next=history.slice(shown,shown+maxDefault);next.forEach(item=>{const e=document.createElement("div");e.className="donation-entry",e.innerHTML=`<strong>${item.name}</strong> - $${item.amount}<br><small>${item.date}</small><br><em>${item.message}</em>`,c.appendChild(e)}),shown+=next.length,shown>=history.length&&(document.getElementById("show-more-btn").style.display="none")};document.getElementById("show-more-btn").addEventListener("click",renderMore),renderMore()}).catch(e=>console.error(e));}();
