<!-- âœ… progress.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Donation Progress</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: transparent;
    }
    .progress-container {
      width: 100%;
      background-color: #f3f3f3;
      border-radius: 8px;
      overflow: hidden;
    }
    .progress-bar {
      height: 20px;
      background-color: #4caf50;
      width: 0%;
      transition: width 0.5s ease-in-out;
    }
    .progress-text {
      text-align: center;
      margin-top: 5px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>
  <div class="progress-text" id="progress-text">Loading...</div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const keyword = urlParams.get("keyword") || "";

    const targetsUrl = "https://opensheet.elk.sh/1AbzUCm0kw5YIVlWHkM1--G2s1hyPNFJr-p76zcQev60/Targets";
    const donationsUrl = "https://opensheet.elk.sh/1AbzUCm0kw5YIVlWHkM1--G2s1hyPNFJr-p76zcQev60/Donations";

    Promise.all([
      fetch(targetsUrl).then(res => res.json()),
      fetch(donationsUrl).then(res => res.json())
    ])
    .then(([targets, donations]) => {
      const target = targets.find(t => t.keyword === keyword);
      if (!target) throw new Error("Target not found");

      const goal = parseFloat(target.goal) || 0;
      const raised = donations
        .filter(d => d.keyword === keyword)
        .reduce((sum, d) => sum + parseFloat(d.amount || 0), 0);

      const percent = Math.min(100, Math.round((raised / goal) * 100));
      document.getElementById("progress-bar").style.width = percent + "%";
      document.getElementById("progress-text").innerText = `$${raised.toLocaleString()} / $${goal.toLocaleString()} (${percent}%)`;
    })
    .catch(err => {
      console.error(err);
      document.getElementById("progress-text").innerText = "Error loading progress.";
    });
  </script>
</body>
</html>
